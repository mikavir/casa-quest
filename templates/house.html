{% extends "base.html" %}
{% block content %}
<div class="row">
    <div class="col">
        <button class="btn waves-effect waves-light" onclick="history.go(-1)">
            Back
        </button>
    </div>
</div>

<div class="row">
    <div class="col s12">
        <div class="card-panel teal lighten-4 row p-5">
            <div class="col s12 m6">
                <img src="{{house.image_url}}" class="responsive-img">
            </div>
            <div class="col s12 m6 center m-2">
                <div class="row">
                    <div class="col s12">
                        <h4 class="center-align green-text text-darken-4">
                            {{ house.address }}
                        </h4>
                    </div>
                </div>
                <div class="row">
                    <div class="col s12">
                        <h5>{{ house.agency }} </h5>
                    </div>

                </div>
                <div class="col s12">
                    <h6 class="center-align black-text text-darken-4">
                        {{ house.propertyType }}
                    </h6>
                </div>
                <div class="row">
                    <div class="col s12">
                        <h6 class="center-align black-text text-darken-4">
                            Â£ {{ house.price }}
                        </h6>
                    </div>
                </div>

                <div class="row m-2">
                    <div class="col s12">
                        <span class="m-2"><i class="fa-solid fa-bed prefix"></i>{{ house.bedrooms }}</span>
                        <span class="m-2"><i class="fa-solid fa-toilet prefix"></i>{{ house.bathrooms }}</span>
                    </div>

                </div>
                <div class="row m-2">
                    <div class="col s12">
                        <span><i class="fa-solid fa-calendar-days prefix"></i> {{ house.date_viewing }}</span>
                    </div>

                </div>

            </div>

        </div>


    </div>

</div>


<!-- house info -->
<div class="row">
    <div class="col s12">
        <div class="card-panel teal row white-text center">
            <div class="col s12">
                <div class="row left-align">
                    <div class="col s6 m6 m-3 ">
                        <span> <i class="material-icons">bolt</i> EPC: </span>
                        <span class="house-info-content">{{ house_info.epc }}</span>

                    </div>
                    <div class="col s6 m6 m-3">
                        <span> <i class="material-icons">payments</i> Tax Band: </span>
                        <span class="house-info-content">{{ house_info.taxBand }} </span>

                    </div>
                </div>
                <div class="row left-align">
                    <div class="col s6 m6 m-3">
                        <span> <i class="material-icons prefix">flood</i> Flood Risk: </span>
                        <span class="house-info-content">{{ house_info.floodRisk }}</span>

                    </div>
                    <div class="col s6 m6 m-3">
                        <span><i class="material-icons prefix">wifi</i> Internet Speed: </span>
                        <span class="house-info-content">{{ house_info.internetSpeed }} </span>

                    </div>
                </div>
                <div class="row">
                    <div class="col s12 m-3">
                        <span> <i class="material-icons prefix">local_parking</i> Dedicated Parking </span>
                        <span class="house-info-content">{{ house_info.dedicatedParking }}</span>

                    </div>
                </div>

            </div>
            <div class="col s12 center" id="add-house-info">
                <a href="#addInfoModal" class="btn filled white black-text waves-effect waves-light modal-trigger"
                    id="add-houseinfo-btn">
                    Add house info
                </a>
            </div>
            <div class="col s12 center">
                <a href="#editInfoModal" class="btn filled white black-text waves-effect waves-light modal-trigger"
                    id="edit-houseinfo-btn">
                    Edit house info
                </a>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <!-- house viewing -->
    <div class="col s12 m6 l6">
        <div class="card-panel teal row mx-auto">
            <div class="col s12">
                <div class="row m-3">
                    <div class="col s12 m-2">
                        <span class="black-text">What is the seller's situation?</span>                       
                    </div>
                    <div class="col s12 center">
                        <span class="house-info-content white-text">{{ house_viewing.sellersSituation }}</span>

                    </div>
                </div>
                <div class="row m-3">
                    <div class="col s12 m-2">
                        <span class="black-text">How are the nighbours?</span>                       
                    </div>
                    <div class="col s12 center">
                        <span class="house-info-content white-text">{{ house_viewing.neighbours }}</span>

                    </div>
                </div>
                <div class="row m-3">
                    <div class="col s12 m-2">
                        <span class="black-text">What are the facilities?</span>                       
                    </div>
                    <div class="col s12 center">
                        <span class="house-info-content white-text">{{ house_viewing.facilities }}</span>

                    </div>
                </div>
                <div class="row m-3">
                    <div class="col s12 m-2">
                        <span class="black-text">How is the traffic?</span>                       
                    </div>
                    <div class="col s12 center">
                        <span class="house-info-content white-text">{{ house_viewing.traffic }}</span>

                    </div>
                </div>
                <div class="row m-3">
                    <div class="col s12 m-2">
                        <span class="black-text">Have there been other offers?</span>                       
                    </div>
                    <div class="col s12 center">
                        <span class="house-info-content white-text">{{ house_viewing.otherOffers }}</span>

                    </div>
                </div>
                <div class="row m-3">
                    <div class="col s12 m-2">
                        <span class="black-text">Are the window's double glazed?</span>                       
                    </div>
                    <div class="col s12 center">
                        <span class="house-info-content white-text">{{ house_viewing.windows }}</span>

                    </div>
                </div>
            
            </div>
            <div class="col s12" id="add-house-check">
                <a href="#addHouseViewingModal" class="btn filled white black-text waves-effect waves-light modal-trigger"
                    id="add-houseviewing-btn">
                    Add house viewing
                </a>
                <a href="#editHouseViewingModal" class="btn filled white black-text waves-effect waves-light modal-trigger"
                    id="edit-houseviewing-btn">
                    Edit house viewing
                </a>

            </div>
        </div>
        <!-- house checks -->
    </div>
    <div class="col s12 m6 l6">
        <div class="card-panel teal row mx-auto">
            <div class="col s12">
                <div class="row m-3">
                    <div class="col s12 m-2">
                        <span class="black-text">Which way does the property face? (Important for light)</span>                       
                    </div>
                    <div class="col s12 center">
                        <span class="house-info-content white-text">{{ house_check.propertyFacing }}</span>

                    </div>
                </div>
                <div class="row m-3">
                    <div class="col s12 m-2">
                        <span class="black-text">How much can you hear outside?</span>                       
                    </div>
                    <div class="col s12 center">
                        <span class="house-info-content white-text">{{ house_check.noisePollution }}</span>

                    </div>
                </div>
                <div class="row m-3">
                    <div class="col s12 m-2">
                        <span class="black-text">How is the storage space?</span>                       
                    </div>
                    <div class="col s12 center">
                        <span class="house-info-content white-text">{{ house_check.storageSpace }}</span>

                    </div>
                </div>
                <div class="row m-3">
                    <div class="col s12 m-2">
                        <span class="black-text">Is it easy to access the attic?</span>                       
                    </div>
                    <div class="col s12 center">
                        <span class="house-info-content white-text">{{ house_check.atticAccess }}</span>

                    </div>
                </div>
                <div class="row m-3">
                    <div class="col s12 m-2">
                        <span class="black-text">Is there a good amount of electric ports available?</span>                       
                    </div>
                    <div class="col s12 center">
                        <span class="house-info-content white-text">{{ house_check.electricPorts }}</span>

                    </div>
                </div>
                <div class="row m-3">
                    <div class="col s12 m-2">
                        <span class="black-text">Are there visible signs of mould?</span>                       
                    </div>
                    <div class="col s12 center">
                        <span class="house-info-content white-text">{{ house_check.mould }}</span>

                    </div>
                </div>
                <div class="row m-3">
                    <div class="col s12 m-2">
                        <span class="black-text">Are there visible signs of damp</span>                       
                    </div>
                    <div class="col s12 center">
                        <span class="house-info-content white-text">{{ house_check.damp }}</span>

                    </div>
                </div>
                <div class="row m-3">
                    <div class="col s12 m-2">
                        <span class="black-text">Are there visible signs of wall cracking?</span>                       
                    </div>
                    <div class="col s12 center">
                        <span class="house-info-content white-text">{{ house_check.crack }}</span>

                    </div>
                </div>
                <div class="row m-3">
                    <div class="col s12 m-2">
                        <span class="black-text">Codition of the roof?</span>                       
                    </div>
                    <div class="col s12 center">
                        <span class="house-info-content white-text">{{ house_check.roofCondition }}</span>

                    </div>
                </div>
            </div>
            <div class="col s12 " id="add-house-check">
                <a href="#addHouseCheckModal" class="btn filled white black-text waves-effect waves-light modal-trigger"
                    id="add-housecheck-btn">
                    Add house checks
                </a>
                <a href="#editHouseCheckModal" class="btn filled white black-text waves-effect waves-light modal-trigger"
                    id="edit-housecheck-btn">
                    Edit house checks
                </a>

            </div>
        </div>
    </div>


</div>



<!--  MODALS -->


<!-- Edit house info modal -->
<div id="editInfoModal" class="modal teal lighten-4">
    <div class="modal-content">
        <form action="{{ url_for('edit_house_info', house_id=house._id) }}" method="POST">
            <!-- input field for EPC -->
            <div class="row">
                <div class="input-field col s12 outlined m-3">
                    <i class="material-icons prefix">bolt</i>
                    <input id="epc" name="epc" type="text" class="validate" required value="{{ house_info.epc }}">
                    <label for="epc">
                        EPC Rating:</label>
                </div>
            </div>
            <!-- input field for Tax-Band -->
            <div class="row">
                <div class="input-field col s12 outlined m-3">
                    <i class="material-icons prefix">payments</i>
                    <input id="tax_band" name="tax_band" type="text" class="validate" required
                        value="{{ house_info.taxBand }}">
                    <label for="tax_band">Tax Band</label>
                </div>

            </div>

            <!-- input field for flood risk -->
            <div class="row">
                <div class="input-field outlined col s12 m-3">
                    <i class="material-icons prefix">flood</i>
                    <input id="flood_risk" name="flood_risk" type="text" class="validate"
                        value="{{ house_info.floodRisk }}" required>
                    <label for="flood_risk">Flood Risk</label>
                </div>

            </div>

            <!-- input field for wifi -->
            <div class="row">
                <div class="input-field outlined col s12 m-3">
                    <i class="material-icons prefix">wifi</i>
                    <input id="internet_speed" name="internet_speed" type="text" class="validate"
                        value="{{ house_info.internetSpeed }}" required>
                    <label for="interned_speed">Internet Speed:</label>
                </div>

            </div>
            <!-- input field for parking -->
            <div class="row">
                <div class="col s12  center">
                    <label for="dedicated_parking">
                        {% if house_info.dedicatedParking == "yes" %}
                        <input name="dedicated_parking" id="dedicated_parking" type="checkbox" class="filled-in"
                            checked="checked" required />
                        {% else %}
                        <input name="dedicated_parking" id="dedicated_parking" type="checkbox" class="filled-in"
                            required />
                        {% endif %}
                        <span>Dedicated Parking</span>
                    </label>
                </div>
            </div>
            <div class="row center">
                <div class="col s12 m-3">
                    <button class="btn filled icon-left waves-effect waves-light teal white-text" type="submit">
                        <i class="material-icons">add</i>Update House Information
                    </button>
                </div>
            </div>


        </form>

    </div>
    <div class="modal-footer">
        <a href="#!" class="modal-close waves-effect btn">Close</a>

    </div>
</div>

<!-- Add house info modal -->
<div id="addInfoModal" class="modal teal lighten-4">
    <div class="modal-content">
        <form action="{{ url_for('add_house_info', house_id=house._id) }}" method="POST">
            <!-- input field for EPC -->
            <div class="row">
                <div class="input-field col s12 outlined m-3">
                    <i class="material-icons prefix">bolt</i>
                    <input id="epc" name="epc" type="text" class="validate" required>
                    <label for="epc">
                        EPC Rating:</label>
                </div>
            </div>
            <!-- input field for Tax-Band -->
            <div class="row">
                <div class="input-field col s12 outlined m-3">
                    <i class="material-icons prefix">payments</i>
                    <input id="tax_band" name="tax_band" type="text" class="validate" required>
                    <label for="tax_band">Tax Band</label>
                </div>

            </div>

            <!-- input field for flood risk -->
            <div class="row">
                <div class="input-field outlined col s12 m-3">
                    <i class="material-icons prefix">flood</i>
                    <input id="flood_risk" name="flood_risk" type="text" class="validate" required>
                    <label for="flood_risk">Flood Risk</label>
                </div>

            </div>

            <!-- input field for wifi -->
            <div class="row">
                <div class="input-field outlined col s12 m-3">
                    <i class="material-icons prefix">wifi</i>
                    <input id="internet_speed" name="internet_speed" type="text" class="validate" required>
                    <label for="interned_speed">Internet Speed:</label>
                </div>

            </div>
            <!-- input field for parking -->
            <div class="row">
                <div class="col s12  center">
                    <label for="dedicated_parking">
                        <input name="dedicated_parking" id="dedicated_parking" type="checkbox" class="filled-in"
                            checked="checked" required />
                        <span>Dedicated Parking</span>
                    </label>
                </div>
            </div>
            <div class="row center">
                <div class="col s12 m-3">
                    <button class="btn filled icon-left waves-effect waves-light teal white-text" type="submit">
                        <i class="material-icons">add</i>Add House Information
                    </button>
                </div>
            </div>


        </form>

    </div>
    <div class="modal-footer">
        <a href="#!" class="modal-close waves-effect btn">Close</a>

    </div>
</div>

<!-- Add house Viewing modal -->
<div id="addHouseViewingModal" class="modal teal lighten-4">
    <div class="modal-content">
        <form action="{{ url_for('add_house_viewing', house_id=house._id) }}" method="POST">
       
            <div class="row">
                <div class="input-field outlined col s12 m-3">
                    <i class="material-icons prefix">people_outline</i>
                    <input id="sellers-situation" name="sellers-sitaution" type="text" class="validate" required>
                    <label for="sellers-sitaution">What is the seller's situation?</label>
                </div>

            </div>
            <div class="row">
                <div class="input-field outlined col s12 m-3">
                    <i class="material-icons prefix">person_search</i>
                    <input id="neighbours" name="neighbours" type="text" class="validate" required>
                    <label for="neighbours">How are the neighbours?</label>
                </div>

            </div>
            <div class="row">
                <div class="input-field outlined col s12 m-3">
                    <i class="material-icons prefix">explore</i>
                    <input id="facilities" name="facilities" type="text" class="validate" required>
                    <label for="facilities">What are the facilities nearby?</label>
                </div>

            </div>
            <div class="row">
                <div class="col s12 left-align">
                    <p>How's the traffic?</p>
                </div>
                <div class="input-field col s12 m-3 center">
                    {% for severity in traffic %}
                        <span>
                            <label>
                                <input name="traffic" type="radio" value="{{ severity }}"/>
                                <span>{{severity}}</span>
                            </label>
                        </span>
                    {% endfor %}
                </div>

            </div>
            <div class="row">
                <div class="col s12 m6 m-4">
                    <label for="offers">
                        <input name="offers" id="offers" type="checkbox" class="filled-in"
                            checked="checked" required />
                        <span>Has there been other offers?</span>
                    </label>
                </div>
                <div class="col s12 m6 m-4">
                    <label for="windows">
                        <input name="windows" id="windows" type="checkbox" class="filled-in"
                            checked="checked" required />
                        <span>Are the windows double-glazed?</span>
                    </label>
                </div>
            </div>
            <div class="row center">
                <div class="col s12">
                    
                    <button class="btn filled icon-left waves-effect waves-light teal white-text" type="submit">
                        <i class="material-icons">add</i>Add House Viewing Information
                    </button>
                </div>
            </div>
        </form>

    </div>
    <div class="modal-footer">
        <a href="#!" class="modal-close waves-effect btn">Close</a>

    </div>
</div>


<!-- Edit house viewing Modal -->
<div id="editHouseViewingModal" class="modal teal lighten-4">
    <div class="modal-content">
        <form action="{{ url_for('edit_house_viewing', house_id=house._id) }}" method="POST">
       
            <div class="row">
                <div class="input-field outlined col s12 m-3">
                    <i class="material-icons prefix">people_outline</i>
                    <input id="sellers-situation" name="sellers-sitaution" type="text" class="validate" value="{{ house_viewing.sellersSituation }} " required>
                    <label for="sellers-sitaution">What is the seller's situation?</label>
                </div>

            </div>
            <div class="row">
                <div class="input-field outlined col s12 m-3">
                    <i class="material-icons prefix">person_search</i>
                    <input id="neighbours" name="neighbours" type="text" class="validate" value=" {{ house_viewing.neighbours }}"required>
                    <label for="neighbours">How are the neighbours?</label>
                </div>

            </div>
            <div class="row">
                <div class="input-field outlined col s12 m-3">
                    <i class="material-icons prefix">explore</i>
                    <input id="facilities" name="facilities" type="text" class="validate" value=" {{ house_viewing.facilities}}"required>
                    <label for="facilities">What are the facilities nearby?</label>
                </div>

            </div>
            <div class="row">
                <div class="col s12 left-align">
                    <p>How's the traffic?</p>
                </div>
                <div class="input-field col s12 m-3 center">
                    {% for severity in traffic %}
                        <span>
                            <label>
                                {% if house_viewing.traffic == severity %}
                                <input name="traffic" type="radio" value="{{ severity }}" checked/>
                                <span>{{ severity }}</span>
                                {% else %}
                                <input name="traffic" type="radio" value="{{ severity }}"/>
                                <span>{{ severity }}</span>
                                {% endif %}

                            </label>
                        </span>
                    {% endfor %}
                </div>

            </div>
            <div class="row">
                <div class="col s12 m6 m-4">
                    <label for="offers">
                        {% if house_viewing.otherOffers == "yes" %}
                            <input name="offers" id="offers" type="checkbox" class="filled-in"
                                checked="checked" required />
                        {% else %}
                            <input name="offers" id="offers" type="checkbox" class="filled-in"
                             required />
                        {% endif %}
                        <span>Has there been other offers?</span>
                    </label>
                </div>
                <div class="col s12 m6 m-4">
                    <label for="windows">
                        {% if house_viewing.windows == "yes" %}
                            <input name="windows" id="windows" type="checkbox" class="filled-in"
                                checked="checked" required />
                        {% else %}
                            <input name="windows" id="windows" type="checkbox" class="filled-in"
                            required />
                        {% endif %}

                        <span>Are the windows double-glazed?</span>
                    </label>
                </div>
            </div>
            <div class="row center">
                <div class="col s12">   
                    <button class="btn filled icon-left waves-effect waves-light teal white-text" type="submit">
                        <i class="material-icons">add</i>Edit House Viewing Information
                    </button>
                </div>
            </div>
        </form>

    </div>
    <div class="modal-footer">
        <a href="#!" class="modal-close waves-effect btn">Close</a>

    </div>
</div>


<!-- Add house checks modal -->

<div id="addHouseCheckModal" class="modal teal lighten-4">
    <div class="modal-content">
        <form action="{{ url_for('add_house_check', house_id=house._id) }}" method="POST">
       
           <div class="row">
                <div class="col s12 ">
                    <div class="row">
                        <div class="col s12 left-align">
                            <p>Which direction does the property face the sun?</p>
                        </div>
                        <div class="input-field col s12">
                            {% for direction in property_facing %}
                                <span>
                                    <label>
                                        <input name="property_facing" type="radio" value="{{ direction }}"/>
                                        <span>{{ direction }}</span>
                                    </label>
                                </span>
                            {% endfor %}
                        </div>
                    </div>
                    <div class="row">
                        <div class="col s12 left-align">
                            <p>How much can you hear outside?</p>
                        </div>
                        <div class="input-field col s12">
                            {% for level in noise %}
                                <span>
                                    <label>
                                        <input name="noise_level" type="radio" value="{{ level }}"/>
                                        <span>{{ level }}</span>
                                    </label>
                                </span>
                            {% endfor %}
                        </div>
                    </div>
                    <div class="row">
                        <div class="col s12 left-align">
                            <p>How noisy is the boiler?</p>
                        </div>
                        <div class="input-field col s12">
                            {% for level in noise %}
                                <span>
                                    <label>
                                        <input name="boiler_noise" type="radio" value="{{ level }}"/>
                                        <span>{{ level }}</span>
                                    </label>
                                </span>
                            {% endfor %}
                        </div>
                    </div>
                    <div class="row">
                        <div class="col s12 left-align">
                            <p>How much storage space does the house have?</p>
                        </div>
                        <div class="input-field col s12">
                            {% for amount in storage_space %}
                                <span>
                                    <label>
                                        <input name="storage_space" type="radio" value="{{ amount }}"/>
                                        <span>{{ amount }}</span>
                                    </label>
                                </span>
                            {% endfor %}
                        </div>
                    </div>
                    <div class="row">
                        <div class="col s12 m6 m-4">
                            <label for="attic">
                                <input name="attic" id="attic" type="checkbox" class="filled-in"/>
                                <span>Is there easy access to the attic?</span>
                            </label>
                        </div>
                        <div class="col s12 m6 m-4">
                            <label for="electric_ports">
                                <input name="electric_ports" id="electric_ports" type="checkbox" class="filled-in"/>
                                <span>Are there decent amounts of electric port?</span>
                            </label>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col s12 m6 m-4">
                            <label for="mould">
                                <input name="mould" id="mould" type="checkbox" class="filled-in"
                                     />
                                <span>Are there signs of mould?</span>
                            </label>
                        </div>
                        <div class="col s12 m6 m-4">
                            <label for="damp">
                                <input name="damp" id="damp" type="checkbox" class="filled-in"/>
                                <span>Are there signs of damp in the walls?</span>
                            </label>
                        </div>
                       
                    </div>
                    <div class="row">
                        <div class="col s12">
                            <label for="crack">
                                <input name="crack" id="crack" type="checkbox" class="filled-in"/>
                                <span>Are there signs of wall cracking?</span>
                            </label>

                        </div>
                    </div>
                    <div class="row">
                        <div class="col s12">
                            <div class="row">
                                <div class="col s12">
                                    <p>Condition of the roof:                                        
                                    </p>                                    
                                </div>
                                <div class="input-field col s12">
                                    {% for condition in roof_condition %}
                                        <span class="m-2">
                                            <label>
                                                <input name="roof_condition" type="radio" value="{{ condition[0] }}"/>
                                                <span>{{ condition[0] }} </span>
                                            </label>
                                            
                                            <button class="btn p-1 rounded green tooltipped" data-position="bottom" data-tooltip="{{condition[1]}}"><i class="fa-sharp fa-solid fa-circle-info"></i></button>
                                            
                                        </span>
                                    {% endfor %}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>                                
            </div>
            <div class="row">
                <div class="col s12 center m-3">                    
                    <button class="btn filled icon-left waves-effect waves-light teal white-text" type="submit">
                        <i class="material-icons">add</i>Add Personal Checks
                    </button>
                </div>
            </div>
        </form>

    </div>
    <div class="modal-footer">
        <a href="#!" class="modal-close waves-effect btn">Close</a>

    </div>
</div>

<!-- Edit personal house checks -->
<div id="editHouseCheckModal" class="modal teal lighten-4">
    <div class="modal-content">
        <form action="#" method="POST">
       
           <div class="row">
                <div class="col s12">
                    
                    <button class="btn filled icon-left waves-effect waves-light teal white-text" type="submit">
                        <i class="material-icons">add</i>Update Personal Checks
                    </button>
                </div>
            </div>
        </form>

    </div>
    <div class="modal-footer">
        <a href="#!" class="modal-close waves-effect btn">Close</a>

    </div>
</div>

<!-- script -->

<script>
    console.log(isThereHouseContent());
    setInterval(addInfoBtnDisplay(), 300);


    function isThereHouseContent() {
        const houseInfoContent = document.querySelectorAll(".house-info-content")
        for (const houseInfo of houseInfoContent) {
            if (houseInfo.innerText !== "") {
                return true;
            }
        }
        return false;
    }

    function addInfoBtnDisplay() {
        const addInfoBtn = document.getElementById("add-houseinfo-btn");
        const editInfoBtn = document.getElementById("edit-houseinfo-btn");

        if (isThereHouseContent) {
            editInfoBtn.style.display = "block";
            addInfoBtn.style.display = "none";
        } else {
            editInfoBtn.style.display = "none";
            addInfoBtn.style.display = "block";
        }
    }
</script>


{% endblock %}